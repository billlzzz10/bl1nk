<!-- metadata: {
  "checksum": "e43b060951567477780b2170e32305bf041113521080d4dcaf8a608f0d08fe15",
  "updated": "2025-11-07T05:12:12.344Z"
} -->


# Metadata Maintenance Guide

ระบบ `bl1nkOS` ใช้ metadata อัตโนมัติสำหรับไฟล์โครงสร้างหลักเพื่อการตรวจสอบความปลอดภัยและความสอดคล้องของ artifact ต่างๆ.

## ไฟล์ที่อยู่ภายใต้การดูแลของสคริปต์

ตารางด้านล่างคือรายการไฟล์ที่ต้องมี metadata อัปเดตอัตโนมัติ

| Path | ประเภท | หมายเหตุ |
| --- | --- | --- |
| `constitution/system-map.json` | JSON | แหล่งข้อมูลแผนผังระบบเพื่อการประเมินผลกระทบด้านความปลอดภัย |
| `doc/operations/index.md` | Markdown | ดัชนีรวม runbook ปฏิบัติการ |
| `doc/operations/metadata-maintenance.md` | Markdown | คู่มือการดูแล metadata และการใช้งานสคริปต์ |

## คำสั่งอัปเดตอัตโนมัติ

รันสคริปต์ด้วยคำสั่งต่อไปนี้จากราก repository:

```bash
npm run update:system-metadata
```

ตัวเลือก CLI เพิ่มเติม:

- `--dry-run` แสดงผลลัพธ์โดยไม่เขียนไฟล์จริง ใช้ตรวจสอบก่อน commit
- `--path=<file>` หรือ `--paths=file1,file2` จำกัดการทำงานเฉพาะไฟล์ที่ระบุ

## กระบวนการตรวจสอบ

1. รันคำสั่งพร้อม `--dry-run` เพื่อตรวจสอบความเปลี่ยนแปลงที่คาดว่าจะเกิดขึ้น
2. หากไม่มีข้อผิดพลาด ให้รันคำสั่งเต็มเพื่ออัปเดต metadata
3. ตรวจสอบ diff และทดสอบด้วย `npm test` เพื่อยืนยันว่า schema validation ครอบคลุม
4. Commit พร้อมบันทึกการเปลี่ยนแปลงใน PR โดยแนบผลการรันคำสั่ง

> หมายเหตุ: สคริปต์จะสร้าง checksum แบบ SHA-256 และ timestamp ISO8601 เพื่อช่วยตรวจจับการเปลี่ยนแปลงที่ไม่ได้รับอนุญาต
